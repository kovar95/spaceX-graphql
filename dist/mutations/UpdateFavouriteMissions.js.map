{"version":3,"file":"UpdateFavouriteMissions.js","sourceRoot":"/","sources":["mutations/UpdateFavouriteMissions.ts"],"names":[],"mappings":";;;;;AAAA,qCAAwD;AACxD,0DAAkC;AAClC,iFAAgE;AAEhE,kBAAe;IACb,IAAI,EAAE,iBAAc;IACpB,IAAI,EAAE;QACJ,EAAE,EAAE,EAAE,IAAI,EAAE,IAAI,wBAAc,CAAC,uBAAa,CAAC,EAAE;QAC/C,QAAQ,EAAE,EAAE,IAAI,EAAE,IAAI,wBAAc,CAAC,uBAAa,CAAC,EAAE;KACtD;IACD,KAAK,CAAC,OAAO,CACX,CAAU,EACV,EAAE,EAAE,EAAE,QAAQ,EAAoC;QAElD,MAAM,IAAI,GAAG,MAAM,cAAI,CAAC,OAAO,CAAC,EAAE,IAAI,EAAE,QAAQ,EAAE,CAAC,CAAC;QAEpD,MAAM,iBAAiB,GAAG,IAAI,EAAE,iBAAiB,IAAI,EAAE,CAAC;QAExD,IAAI,cAAwB,CAAC;QAE7B,IAAI,iBAAiB,CAAC,QAAQ,CAAC,EAAE,CAAC,EAAE;YAClC,cAAc,GAAG,iBAAiB,CAAC,MAAM,CACvC,CAAC,SAAS,EAAE,EAAE,CAAC,SAAS,KAAK,EAAE,CAChC,CAAC;SACH;aAAM;YACL,cAAc,GAAG,CAAC,GAAG,iBAAiB,EAAE,EAAE,CAAC,CAAC;SAC7C;QAED,IAAI,IAAI,EAAE;YACR,IAAI,CAAC,iBAAiB,GAAG,cAAc,CAAC;YACxC,IAAI,CAAC,IAAI,EAAE,CAAC;SACb;QACD,OAAO;YACL,EAAE;YACF,WAAW,EAAE,cAAc,CAAC,QAAQ,CAAC,EAAE,CAAC;SACzC,CAAC;IACJ,CAAC;CACF,CAAC","sourcesContent":["import { GraphQLNonNull, GraphQLString } from \"graphql\";\nimport User from \"../models/user\";\nimport GraphQLMission from \"../services/spaceX/outputs/Mission\";\n\nexport default {\n  type: GraphQLMission,\n  args: {\n    id: { type: new GraphQLNonNull(GraphQLString) },\n    userName: { type: new GraphQLNonNull(GraphQLString) },\n  },\n  async resolve(\n    _: unknown,\n    { id, userName }: { id: string; userName: string }\n  ) {\n    const user = await User.findOne({ name: userName });\n\n    const favouriteMissions = user?.favouriteMissions ?? [];\n\n    let newFavMissions: string[];\n\n    if (favouriteMissions.includes(id)) {\n      newFavMissions = favouriteMissions.filter(\n        (missionId) => missionId !== id\n      );\n    } else {\n      newFavMissions = [...favouriteMissions, id];\n    }\n\n    if (user) {\n      user.favouriteMissions = newFavMissions;\n      user.save();\n    }\n    return {\n      id,\n      isFavourite: newFavMissions.includes(id),\n    };\n  },\n};\n"]}